function flippyFramey(e){function n(){var n=window.setInterval(function(){var a=g.scheme(g.index);console.log(a),g.images[g.index]=r(a),g.index++,g.index>=e.frames&&(window.clearInterval(n),d.invoke.fetchCompletion())},50)}function a(e){u.drawImage(e.image,0,0,e.width,e.height,0,0,d.canvasElement.width,d.canvasElement.height),d.invoke.draw()}function i(e){a({image:g.images[e],width:g.width,height:g.height}),d.canUpgrade&&(d.pendingUpgrade&&window.clearTimeout(d.pendingUpgrade),d.pendingUpgrade=window.setTimeout(function(){var n=l.scheme(e);if(c(n))t(e);else{l.images[e]=r(n);var a=d.upgradeTries;window.clearTimeout(d.pendingUpgrade),d.pendingUpgrade=window.setInterval(function(){return c(n)?(t(e),d.invoke.upgradeSuccess(),void window.clearInterval(d.pendingUpgrade)):(a--,a?void 0:(window.clearInterval(d.pendingUpgrade),void d.invoke.upgradeFailure()))},d.upgradeDelay)}},d.upgradeDelay))}function t(e){d.canUpgrade&&a({image:l.images[e],width:l.width,height:l.height})}function r(e){var n=new Image;return n.src=e,n}function c(e){return r(e).complete}function o(e){e.forEach(function(e){e(d)})}e=e||{};var d={on:{},stacks:{},invoke:{}};["upgradeSuccess","upgradeFailure","fetchCompletion","draw"].forEach(function(e){d.stacks[e]=[],d.on[e]=function(n){"function"==typeof n&&d.stacks[e].push(n)},d.invoke[e]=function(){o(d.stacks[e])}}),d.canvasId=e.canvas=e.canvas||"canvas";var s=d.canvasElement=document.getElementById(e.canvas),u=d.ctx=s.getContext("2d");if(!e.thumbs)return console.error("flippyFramey expects an object which specifies details regarding your thumbnail image set. See https://github.com/WilliamsNY/flippy-framey for more details"),void console.log("There are no sensible defaults we can assume.        \nTerminating flippyFramey execution NOW.");var g=d.thumbs=e.thumbs;if(g.images={},e.full){d.canUpgrade=!0;var l=d.full=e.full;l.images={},d.upgradeDelay=e.upgradeDelay||50,d.upgradeTries=e.upgradeTries||10}else d.canUpgrade=!1;return"function"==typeof e.callback&&e.callback(d),d.fetchThumbs=e.fetchThumbs||n,d.drawThumb=i,d}